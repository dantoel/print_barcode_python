â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     DOKUMENTASI LENGKAP - CETAK BARCODE DATABASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‘ DAFTAR ISI:
1. Ringkasan Sistem
2. Konfigurasi Database
3. Cara Menggunakan (5 cara)
4. Troubleshooting
5. Technical Details

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. RINGKASAN SISTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TUJUAN:
  Mencetak barcode otomatis dari tabel production_schedule database
  dengan status production_proggress = 'Ready'

DATABASE:
  Host: 192.168.12.250
  User: admin-reka
  Pass: J@debx132
  Database: reka
  Tabel: production_schedule

DATA YANG DIAMBIL:
  - id_product      â†’ Barcode (misal: 686A18101-11)
  - product         â†’ Nama produk (misal: Distribusi K1/K3)
  - workshop        â†’ Workstation (misal: WS01)

FILTER:
  WHERE production_proggress = 'Ready'
  ORDER BY id_product ASC

PRINTER:
  - Tipe: Thermal printer (USB)
  - Driver: Msprintsdk.dll
  - Format: 1D Barcode

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. KONFIGURASI DATABASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STRUKTUR TABEL PRODUCTION_SCHEDULE (yang digunakan):

  Kolom Digunakan:
  â”œâ”€ id_product           : Identitas produk (menjadi barcode)
  â”œâ”€ product              : Nama produk (label di barcode)
  â”œâ”€ production_proggress : Status (filter = 'Ready')
  â””â”€ line                 : Production line (label di barcode)

CONTOH DATA:
  
  id_product    | product              | production_proggress | line
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  686A18101-11  | Distribusi K1/K3     | Ready                | Lt 3 Line 1
  506E12001     | Panel AC Endwall KCI | Ready                | Line AC Endwall KCI
  496A18001     | PIDS A               | Ready                | Lt 3 Line 2

SQL QUERY YANG DIJALANKAN:

  SELECT 
    id_product,
    product,
    line,
    production_proggress
  FROM production_schedule
  WHERE production_proggress = 'Ready'
  ORDER BY id_product ASC

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. CARA MENGGUNAKAN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CARA 1: MENU INTERAKTIF (PALING MUDAH) â­â­â­
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Double-click: MENU_UTAMA.bat
  2. Pilih opsi di menu
  
  Fitur:
  - [1] Print semua data Ready
  - [2] Test print (limit)
  - [3] Debug mode
  - [4] Test database
  - [5] Lihat log
  - [6] Exit

CARA 2: CETAK LANGSUNG
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Double-click: CETAK_DARI_DATABASE.bat
  
  Proses:
  - Koneksi ke database
  - Query data Ready
  - Tampilkan daftar
  - Minta konfirmasi
  - Print semua
  - Tampilkan summary

CARA 3: TEST PRINT (LIMIT)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Double-click: TEST_PRINT.bat
  2. Pilih:
     - [1] Test 1 item
     - [2] Test 5 item
     - [3] Cetak semua

CARA 4: DEBUG MODE (UNTUK ERROR)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  1. Double-click: DEBUG_CETAK.bat
  
  Output akan menampilkan:
  - Step-by-step execution
  - File existence checks
  - DLL loading status
  - Printer initialization
  - All print commands
  - Detailed error messages

CARA 5: COMMAND LINE (ADVANCED)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Buka PowerShell/CMD, jalankan:
  
  cd C:\ws\KodeArduinoUtama\printer02
  
  # Normal
  python cetak_dari_database.py
  
  # Debug
  python cetak_dari_database.py --debug
  
  # Limit 3 item
  python cetak_dari_database.py --limit 3
  
  # Debug + Limit
  python cetak_dari_database.py --debug --limit 5

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

MASALAH 1: Script langsung tutup tanpa error message
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Penyebab:
  - Program error tapi tidak terlihat karena langsung exit

Solusi:
  âœ“ Gunakan batch file (.bat) bukan direct .py
  âœ“ Batch file otomatis pause sebelum exit
  âœ“ Anda bisa baca error message

MASALAH 2: "Could not connect to database"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Penyebab:
  - IP 192.168.12.250 tidak bisa diakses
  - Username/password salah
  - Database server down

Solusi:
  âœ“ Double-click: TEST_DATABASE.bat
  âœ“ Cek IP bisa di-ping: ping 192.168.12.250
  âœ“ Verifikasi credentials: admin-reka / J@debx132
  âœ“ Cek database server running
  âœ“ Cek firewall (port 3306)

MASALAH 3: "DLL file not found"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Penyebab:
  - File Msprintsdk.dll tidak ada di folder printer02
  - Path DLL salah

Solusi:
  âœ“ Cek file ada: C:\ws\KodeArduinoUtama\printer02\Msprintsdk.dll
  âœ“ Jika tidak ada, copy dari backup atau install printer driver
  âœ“ Cek 32-bit vs 64-bit Python (harus match dengan DLL)

MASALAH 4: "Printer not found / USB port error"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Penyebab:
  - Printer tidak terhubung USB
  - Driver printer tidak install
  - Port USB error

Solusi:
  âœ“ Cek printer terhubung via USB
  âœ“ Cek Device Manager â†’ Universal Serial Bus Controllers
  âœ“ Install driver printer jika belum
  âœ“ Coba restart printer dan komputer

MASALAH 5: "No data with status 'Ready'"
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Penyebab:
  - Data di tabel tidak ada dengan status 'Ready'
  - Status berbeda (misal 'Pending', 'Processing')

Solusi:
  âœ“ Cek database via phpmyadmin atau MySQL Workbench
  âœ“ Verifikasi status column: production_proggress
  âœ“ Lihat nilai status yang ada di tabel
  âœ“ Update status produk menjadi 'Ready' di database

MASALAH 6: Barcode tidak keluar (printer nyala tapi tidak print)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Penyebab:
  - Printer offline
  - Kertas habis
  - Error pada printer

Solusi:
  âœ“ Cek status printer (online/offline)
  âœ“ Cek kertas masih ada
  âœ“ Lihat error message di printer
  âœ“ Jalankan DEBUG_CETAK.bat untuk lihat detail

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. TECHNICAL DETAILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

DEPENDENCY (Python Packages):
  - pymysql              : MySQL connector
  - ctypes               : Windows DLL loader
  - Standard library (os, sys, datetime, time, traceback)

STRUKTUR FILE:

  cetak_dari_database.py
  â”œâ”€ import dependencies
  â”œâ”€ DB_CONFIG dictionary
  â”œâ”€ write_log() function
  â”œâ”€ connect_database() function
  â”œâ”€ query_data_siap_cetak() function
  â”œâ”€ cetakBarcode01() function
  â”œâ”€ update_status_setelah_cetak() function
  â”œâ”€ main_loop() function
  â””â”€ if __name__ == "__main__"

FLOW DIAGRAM:

  [User double-click .bat]
         â†“
  [System execute Python]
         â†“
  [Connect to Database]
         â†“
  [Query production_schedule WHERE status='Ready']
         â†“
  [Get list of products]
         â†“
  [Ask user confirmation]
         â†“
  [Load Msprintsdk.dll]
         â†“
  [For each product:
    - Initialize printer
    - Print barcode
    - Update status (optional)
  ]
         â†“
  [Log summary and close]
         â†“
  [Show result to user]

LOG FORMAT:

  [YYYY-MM-DD HH:MM:SS] [STATUS] [MESSAGE]
  
  Contoh:
  [2026-01-02 10:15:30] âœ“ Koneksi database berhasil
  [2026-01-02 10:15:31] âœ“ Query berhasil, ditemukan 3 data siap cetak
  [2026-01-02 10:15:32] âœ“ Cetak BERHASIL: 686A18101-11 - Distribusi K1/K3
  [2026-01-02 10:15:33] SUMMARY: Total=3, Berhasil=3, Gagal=0

PRINTER OUTPUT FORMAT:

  SetAlignment(1)        â†’ Alignment left
  SetSizetext(0, 0)      â†’ Font size normal
  PrintString()          â†’ Print text (workstation)
  PrintChargeRow()       â†’ Line break
  SetSizetext(1, 2)      â†’ Font size larger
  PrintString()          â†’ Print text (product name)
  Print1Dbar()           â†’ Print 1D barcode
  PrintChargeRow()       â†’ 5x line breaks
  PrintCutpaper(1)       â†’ Cut paper
  SetClose()             â†’ Close printer

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

INFORMASI SISTEM:

  Dibuat: 2026-01-02
  Database Host: 192.168.12.250
  Database User: admin-reka
  Database: reka
  Tabel: production_schedule
  Barcode Column: id_product
  Product Column: product
  Status Filter: production_proggress = 'Ready'
  Printer Driver: Msprintsdk.dll
  Log File: cetak_log.txt

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CREATED BY: AI Assistant
LANGUAGE: Python 3.x
OS: Windows
VERSION: 1.0

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
